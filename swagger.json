{
  "swagger": "2.0",
  "host": "virtserver.swaggerhub.com",
  "basePath": "/HaiPiaoAPP/test/1.0.0",
  "schemes": [
    "https"
  ],
  "info": {
    "description": "海漂APP后端API",
    "version": "1.0.0",
    "title": "海漂APP后端API",
    "contact": {
      "email": "haipiao.dev@gmail.com"
    },
    "license": {
      "name": "Apache 2.0",
      "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "tags": [
    {
      "name": "Verified",
      "description": "完成开发并已验证"
    },
    {
      "name": "Developped",
      "description": "已经完成开发"
    },
    {
      "name": "Developing",
      "description": "正在开发"
    },
    {
      "name": "Todo",
      "description": "未开发"
    }
  ],
  "paths": {
    "/security-code/new": {
      "get": {
        "tags": [
          "Developped"
        ],
        "summary": "获取一个验证码（3.1）",
        "description": "客户端为当前用户设备请求一个验证码，请求中需包含当前设备（手机）号码。服务器端返回一个6位验证码，一分钟内有效。\n",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "cell",
            "description": "请求验证码的手机号",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "seccess": {
                  "type": "boolean",
                  "example": true
                },
                "security_code": {
                  "type": "integer",
                  "example": "067218",
                  "minimum": 100000,
                  "maximum": 999999
                }
              }
            }
          },
          "default": {
            "description": "请求失败",
            "schema": {
              "$ref": "#/definitions/ErrorInfo"
            }
          }
        }
      }
    },
    "/security-code/verification": {
      "post": {
        "tags": [
          "Developped"
        ],
        "summary": "验证验证码",
        "description": "客户端请求服务器验证 1. 用户登陆（\"login\"）或 2. 用户注册（\"registration\"）或 3. 用户修改手机号（\"update_cell\"），请求中需包含当前用户手机号码。服务器端需完成验证码验证，如果验证类型为1（用户注册）， 服务端需为请求中的手机号码创建一个新的账户， 如果账户已存在需返回相应错误码。服务器端需返回一个session token。\n",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "验证码信息",
            "description": "验证码信息包括：1. 请求验证码的手机号（`cell`）2. 验证码类型（`type`） 3. 验证码 (`code`)",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "cell": {
                  "type": "string",
                  "example": 8888888
                },
                "type": {
                  "type": "string",
                  "example": "registration"
                },
                "code": {
                  "type": "string",
                  "example": "314489"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "seccess": {
                  "type": "boolean",
                  "example": true
                },
                "data": {
                  "type": "object",
                  "properties": {
                    "seesion_token": {
                      "type": "string",
                      "example": "euMA3jBRShPn/K935B9e0A==:T4p4tBPdDrgD70UbbgGNoQ=="
                    },
                    "issued_time": {
                      "type": "number",
                      "example": 1571641196070
                    }
                  }
                }
              }
            }
          },
          "default": {
            "description": "请求失败",
            "schema": {
              "$ref": "#/definitions/ErrorInfo"
            }
          }
        }
      }
    },
    "/image/updaload": {
      "post": {
        "tags": [
          "Todo"
        ],
        "summary": "创建图片链接",
        "description": "先调用阿里云的OSS服务上传图片，获取返回的url，再调用该API创建一个图片链接。图片类型：1. 文章中图片（`in_article`）2. 头像图片 （`profile`）。 \n",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "图片url信息",
            "description": "",
            "required": true,
            "schema": {
              "type": "object",
              "required": [
                "image_type",
                "image_url"
              ],
              "properties": {
                "image_type": {
                  "type": "string",
                  "example": "profile"
                },
                "image_url": {
                  "type": "string",
                  "format": "url",
                  "example": "aliyun-abc.oss-cn-hangzhou.aliyuncs.com/abc/myphoto.jpg"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "image_id": {
                  "type": "integer",
                  "example": 1234
                }
              }
            }
          },
          "default": {
            "description": "请求失败",
            "schema": {
              "$ref": "#/definitions/ErrorInfo"
            }
          }
        }
      }
    },
    "/user": {
      "post": {
        "tags": [
          "Todo"
        ],
        "summary": "创建一个新用户",
        "description": "创建一个新用户。用于用户注册流程中。",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "header",
            "name": "Cookie",
            "description": "必须包含`seesion_token`（临时session token。当完成验证码验证后，服务器返回一个临时session token）。该token在此次使用后即失效，客户端再后续的请求中应该在`Cookie`中加入该次请求响应中返回的`seesion_token`字段",
            "required": true,
            "type": "string"
          },
          {
            "in": "body",
            "name": "用户信息",
            "description": "",
            "required": true,
            "schema": {
              "type": "object",
              "required": [
                "name",
                "gender",
                "birthday",
                "cell"
              ],
              "properties": {
                "name": {
                  "type": "string",
                  "example": "王小明"
                },
                "gender": {
                  "type": "string",
                  "enum": [
                    "F",
                    "M",
                    "U"
                  ]
                },
                "birthday": {
                  "type": "string",
                  "example": "1992/01/31"
                },
                "cell": {
                  "type": "string",
                  "example": 8888888
                },
                "profile_image_url": {
                  "type": "string",
                  "format": "url",
                  "example": "aliyun-abc.oss-cn-hangzhou.aliyuncs.com/abc/myphoto.jpg"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "创建成功",
            "schema": {
              "type": "object",
              "required": [
                "success"
              ],
              "properties": {
                "success": {
                  "type": "boolean"
                },
                "data": {
                  "type": "object",
                  "required": [
                    "id",
                    "session_token"
                  ],
                  "properties": {
                    "id": {
                      "type": "integer",
                      "example": 100001
                    },
                    "session_token": {
                      "type": "string",
                      "example": "euMA3jBRShPn/K935B9e0A==:T4p4tBPdDrgD70UbbgGNoQ=="
                    }
                  }
                }
              }
            }
          },
          "default": {
            "description": "请求失败",
            "schema": {
              "$ref": "#/definitions/ErrorInfo"
            }
          }
        }
      }
    },
    "/category": {
      "get": {
        "tags": [
          "Todo"
        ],
        "summary": "获取\"分类\"列表",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "type",
            "description": "",
            "required": true,
            "type": "string",
            "enum": [
              "hot",
              "all",
              "misc"
            ]
          },
          {
            "in": "header",
            "name": "Cookie",
            "description": "包含`seesion_token`。如果缺失，则为`visitor mode`(游客模式)",
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "创建成功",
            "schema": {
              "type": "object",
              "required": [
                "success",
                "data"
              ],
              "properties": {
                "sucess": {
                  "type": "boolean"
                },
                "data": {
                  "type": "object",
                  "properties": {
                    "hot": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer",
                            "example": 100012
                          },
                          "name": {
                            "type": "string",
                            "example": "学校"
                          },
                          "cover_image_url": {
                            "type": "string",
                            "format": "url",
                            "example": "aliyun-abc.oss-cn-hangzhou.aliyuncs.com/abc/school.jpg"
                          }
                        }
                      }
                    },
                    "all": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer",
                            "example": 100012
                          },
                          "name": {
                            "type": "string",
                            "example": "工作"
                          },
                          "cover_image_url": {
                            "type": "string",
                            "format": "url",
                            "example": "aliyun-abc.oss-cn-hangzhou.aliyuncs.com/abc/work.jpg"
                          }
                        }
                      }
                    },
                    "misc": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "integer",
                            "example": 100012
                          },
                          "name": {
                            "type": "string",
                            "example": "旅游"
                          },
                          "cover_image_url": {
                            "type": "string",
                            "format": "url",
                            "example": "aliyun-abc.oss-cn-hangzhou.aliyuncs.com/abc/travel.jpg"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "default": {
            "description": "请求失败",
            "schema": {
              "$ref": "#/definitions/ErrorInfo"
            }
          }
        }
      }
    },
    "/user/category": {
      "post": {
        "tags": [
          "Todo"
        ],
        "summary": "添加用户关注的\"分类\"",
        "description": "添加用户关注的\"分类\"。每个分类由一个integer类型的id唯一识别。",
        "parameters": [
          {
            "in": "header",
            "name": "Cookie",
            "required": true,
            "description": "必须包含`seesion_token`。不支持`visitor mode`(游客模式)",
            "type": "string"
          },
          {
            "in": "body",
            "name": "分类列表",
            "description": "",
            "required": true,
            "schema": {
              "type": "object",
              "required": [
                "categories"
              ],
              "properties": {
                "categories": {
                  "type": "array",
                  "items": {
                    "type": "integer",
                    "example": [
                      100001,
                      200001,
                      300001
                    ]
                  }
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "type": "boolean"
                }
              }
            }
          },
          "default": {
            "description": "请求失败",
            "schema": {
              "$ref": "#/definitions/ErrorInfo"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "ErrorInfo": {
      "type": "object",
      "required": [
        "success",
        "error"
      ],
      "properties": {
        "seccess": {
          "type": "boolean",
          "example": false
        },
        "error": {
          "type": "object",
          "required": [
            "error_code"
          ],
          "properties": {
            "error_code": {
              "type": "string",
              "example": "INTERNAL_SERVER_ERROR"
            },
            "error_message": {
              "type": "string",
              "example": "vender service denied request"
            }
          }
        }
      }
    }
  }
}